added main bulk of interactive code, and update for windows users